<!doctype html>
<html lang="en">
<head>
  <title>Avaje</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" href="/images/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Source+Sans+Pro|Ubuntu&display=swap">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/reset.css">
  <link rel="stylesheet" href="/css/site.css">
  <link rel="stylesheet" href="/css/pygments.css">
</head>
<body>

<div class="container">
  <aside id="sidenav">
    <nav class="side scroll">
<ul>
  <li><a href="#overview">Overview</a>
</li>
<li><a href="#default-types">Default Supported Types</a>
</li>
<li><a href="#quick-start">Quick Start</a>
</li>
<li><a href="#integration">Spring/Avaje Integration</a>
<li><a href="#jpms">Java Modules</a>
</li>
</li>
<li><a href="#json">@Json</a>
    <ul>
      <li><a href="#adapter">Generated JsonAdapter</a></li>
      <li><a href="#import">@Import</a></li>
      <li><a href="#raw">@Raw</a></li>
      <li><a href="#property">@Property</a></li>
      <li><a href="#alias">@Alias</a></li>
      <li><a href="#iggy">@Ignore</a></li>
      <li><a href="#mapped">@Unmapped</a></li>
      <li><a href="#value">@Value</a></li>
      <li><a href="#mixin">@Mixin</a></li>
      <li><a href="#subtype">@Subtype</a></li>
    </ul>
</li>
<li><a href="#custom">@CustomAdapter</a>
</li>
</ul>
<p>&nbsp;</p>
    </nav>
  </aside>
  <article id="main-content">
    <header>
      <nav id="top">
        <div class="breadcrumb"><a href="/">avaje</a><span class="sep">&nbsp;/&nbsp;</span><span class="last">jsonb</span></div>
        <ul>
          <li><a href="/" title="home"><i class="fas fa-home"></i></a></li>
          <li><a href="https://github.com/avaje/avaje-jsonb" title="github source"><i class="fab fa-github"></i></a></li>
          <li><a onclick="toggleTheme();" title="switch dark light theme"><i class="fas fa-adjust"></i></a></li>
        </ul>
      </nav>
    </header>
    

<h1 id="overview">Avaje Jsonb</h1>

<table style="width: 100%;">
  <tr>
    <th>License</th>
    <th>Source</th>
    <th>API Docs</th>
    <th>Issues</th>
    <th>Releases</th>
  </tr>
  <tr>
    <td><a target="_blank" href="https://github.com/avaje/avaje-jsonb/blob/master/LICENSE">Apache2</a></td>
    <td><a target="_blank" href="https://github.com/avaje/avaje-jsonb">Github</a></td>
    <td><a target="_blank" href="/apidocs/avaje-jsonb">Javadoc</a></td>
    <td><a target="_blank" href="https://github.com/avaje/avaje-jsonb/issues">Github</a></td>
    <td><a href="https://github.com/avaje/avaje-jsonb/releases"><img src="https://img.shields.io/maven-central/v/io.avaje/avaje-jsonb.svg?label=Maven%20Central"></a></td>
  </tr>
</table>

<p><br><br>
  This is a light (~200kb + generated code), fast, and reflection free Json binding library
</p>

<ul>
  <li>Use Java annotation processing to generate java source for adapting JSON to/from java objects</li>
  <li>No need to manually register generated adapters. (Uses service loading to auto-register)</li>
  <li>Has no fallback to reflection - avaje is code generation or bust.</li>
  <li>Constructors and accessors/getters/setters of any style should all "just work" (record type, constructors, 'fluid setters' all just work)</li>
  <li>Jackson-like annotations</li>
  <li>Provide support for dynamic json views</li>
  <li>Supports importing and generating adapters for library types</li>
  <li>Supports Jackson-like mixins</li>
  <li>Supports generic types</li>
</ul>

<h4 id="default-types">Default Supported Types</h4>

<p>
  Jsonb has built-in support for reading and writing Javaâ€™s core data types:
</p>

<ul>
  <li>Primitives (int, float, char...) and their boxed counterparts (Integer, Float, Character...).</li>
  <li>BigInteger and BigDecimal</li>
  <li>java.time classes (Instant, LocalDate, LocalDateTime...)</li>
  <li>Arrays, Collections, Streams, Lists, Sets, and Maps</li>
  <li>Strings</li>
  <li>Enums</li>
  <li>Other miscellaneous types (UUID, URL, URI)</li>
</ul>


<h2 id="quick-start">Quick Start</h2>
<h4>
  1. Add <em>avaje.jsonb</em> dependencies.
</h4>
<div class="syntax xml"><div class="highlight"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>io.avaje<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>avaje.jsonb<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>&#36;{avaje.jsonb.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="c">&lt;!-- if using spring web, add the below to use jsonb for http messaging --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>io.avaje<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>avaje-jsonb-spring-starter<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>&#36;{avaje-jsonb-version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>

<h4>
2. Add the annotation processor to your pom.
</h4>
<div class="syntax xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- Annotation processors --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>io.avaje<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>avaje-jsonb-generator<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>&#36;{avaje.jsonb.version}<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
  <span class="nt">&lt;optional&gt;</span>true<span class="nt">&lt;/optional&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>

 <h4>3. Add <code>@Json</code> onto types we want to serialize.</h4>
<p>
  <br>The avaje-jsonb-generator annotation processor will generate a JsonAdapter as java source code for each type annotated with <code>@Json</code>.
  These will be automatically registered with Jsonb using a service loader mechanism.
  <br>For types we can not annotate with <code>@Json</code> we can instead use <code>@Json.Import</code>.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Address</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">street</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">suburb</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">city</span><span class="o">;</span>
  <span class="c1">// object fields will automatically have adapters generated, no @Json required</span>
  <span class="c1">// (though you can add @Json anyway to modify the generated adapter how you wish)</span>
  <span class="kd">private</span> <span class="n">OtherClass</span> <span class="n">other</span><span class="o">;</span>
  <span class="c1">//getters/setters ommited for brevity</span>
<span class="o">}</span>
</pre></div>
</div>

<p>Also works with records:</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">Address</span><span class="o">(</span><span class="n">String</span> <span class="n">street</span><span class="o">,</span> <span class="n">String</span> <span class="n">suburb</span><span class="o">,</span> <span class="n">String</span> <span class="n">city</span><span class="o">){}</span>
</pre></div>
</div>

<h4>
  4. Serialize/Deserialize your JSON/POJO
</h4>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">// build using defaults</span>
<span class="n">Jsonb</span> <span class="n">jsonb</span> <span class="o">=</span> <span class="n">Jsonb</span><span class="o">.</span><span class="na">builder</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>

<span class="n">JsonType</span><span class="o">&lt;</span><span class="n">Customer</span><span class="o">&gt;</span> <span class="n">customerType</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">type</span><span class="o">(</span><span class="n">Customer</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="c1">// If the type is generic we can specify</span>
<span class="c1">// JsonType&lt;Customer&lt;T1,T2,...&gt;&gt; customerType = jsonb.type(Types.newParameterizedType(Customer.class, T1.class,T2.class, ...);</span>

<span class="n">Customer</span> <span class="n">customer</span> <span class="o">=</span> <span class="o">...;</span>

<span class="c1">// serialize to json</span>
<span class="n">String</span> <span class="n">asJson</span> <span class="o">=</span>  <span class="n">customerType</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">customer</span><span class="o">);</span>

<span class="c1">// deserialize from json</span>
<span class="n">Customer</span> <span class="n">customer</span> <span class="o">=</span> <span class="n">customerType</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">asJson</span><span class="o">);</span>
</pre></div>
</div>

<h4>
  5. JsonViews
</h4>
<p>This library supports dynamic json views which allow us to specify which specific properties to include when serialising to json.</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="n">Jsonb</span> <span class="n">jsonb</span> <span class="o">=</span> <span class="n">Jsonb</span><span class="o">.</span><span class="na">builder</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>

<span class="n">JsonType</span><span class="o">&lt;</span><span class="n">Customer</span><span class="o">&gt;</span> <span class="n">customerType</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">type</span><span class="o">(</span><span class="n">Customer</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="c1">// only including the id and name</span>
<span class="n">JsonView</span><span class="o">&lt;</span><span class="n">Customer</span><span class="o">&gt;</span> <span class="n">idAndNameView</span> <span class="o">=</span> <span class="n">customerType</span><span class="o">.</span><span class="na">view</span><span class="o">(</span><span class="s">&quot;(id, name)&quot;</span><span class="o">);</span>

<span class="n">String</span> <span class="n">asJson</span> <span class="o">=</span>  <span class="n">idAndNameView</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">customer</span><span class="o">);</span>

<span class="n">JsonView</span><span class="o">&lt;</span><span class="n">Customer</span><span class="o">&gt;</span> <span class="n">myView</span> <span class="o">=</span>
  <span class="n">customerType</span><span class="o">.</span><span class="na">view</span><span class="o">(</span><span class="s">&quot;(id, name, billingAddress(*), contacts(lastName, email))&quot;</span><span class="o">);</span>

<span class="c1">// serialize to json the above specified properties only</span>
<span class="n">String</span> <span class="n">asJson</span> <span class="o">=</span>  <span class="n">myView</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">customer</span><span class="o">);</span>
</pre></div>
</div>

  <h2 id="integration">Spring/Avaje Inject Integration</h2>
  <p>
    When used with Spring or Avaje Inject, a default <code>Jsonb</code> instance will be provided and used for serializing/deserializing Http messages. The following properties can be added to configure the default instance.

    <div class="syntax java"><div class="highlight"><pre><span></span><span class="n">jsonb</span><span class="o">.</span><span class="na field">deserialize</span><span class="o">.</span><span class="na">failOnUnknown</span> <span class="o">(</span><span class="k">default</span> <span class="kc">false</span><span class="o">)</span>
<span class="n">jsonb</span><span class="o">.</span><span class="na field">serialize</span><span class="o">.</span><span class="na">mathTypesAsString</span> <span class="o">(</span><span class="k">default</span> <span class="kc">false</span><span class="o">)</span>
<span class="n">jsonb</span><span class="o">.</span><span class="na field">serialize</span><span class="o">.</span><span class="na">empty</span> <span class="o">(</span><span class="k">default</span> <span class="kc">true</span><span class="o">)</span>
<span class="n">jsonb</span><span class="o">.</span><span class="na field">serialize</span><span class="o">.</span><span class="na">nulls</span> <span class="o">(</span><span class="k">default</span> <span class="kc">false</span><span class="o">)</span>
</pre></div>
</div>

  </p>

  <h2 id="jpms">Java Module Setup</h2>
  <p>
    If using java modules, in the <code>module-info.java</code> we need to:
  </p>
  <ol>
    <li>Add a <em>requires</em> clause for <em>io.avaje.jsonb</em></li>
    <li>Add a <em>provides</em> clause for <em>io.avaje.jsonb.Jsonb.GeneratedComponent</em></li>
  </ol>

  <h5>Example module-info</h5>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">io.avaje.jsonb.Jsonb.GeneratedComponent</span><span class="o">;</span>

<span class="n">module</span> <span class="n">org</span><span class="o">.</span><span class="na">example</span> <span class="o">{</span>

  <span class="n">requires</span> <span class="n">io</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na">jsonb</span><span class="o">;</span>

  <span class="c1">// you must define the fully qualified class name of the generated classes. if you use an import statement, compilation will fail</span>
  <span class="n">provides</span> <span class="n">GeneratedComponent</span> <span class="n">with</span> <span class="n">org</span><span class="o">.</span><span class="na field">example</span><span class="o">.</span><span class="na field">jsonb</span><span class="o">.</span><span class="na">GeneratedComponent</span><span class="o">;</span>

  <span class="c1">//if running using Jlink application images with avaje-inject add:</span>
  <span class="c1">//requires io.avaje.jsonb.plugin;</span>
<span class="o">}</span>
</pre></div>
</div>
  <p>
   In the example above, <code>org.example.jsonb.GeneratedComponent</code> is generated code typically found in
    <code>target/generated-sources/annotations</code>.
  </p>

<h2 id="json">@Json</h2>
<p>
Types with <code>@Json</code> are picked up by avaje-jsonb-generator at compile time and a JsonAdapter is generated as java source code typically in target/generated-sources/annotations.
</p>
<h4>Constructors</h4>
<p>
  The types can be a record/class and have constructors. When types do not have a default constructor (e.g. record types) then the generated code will use the constructor. Fields in the constructor do not need or use setter methods.
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">//Example record - all fields set via constructor</span>
<span class="nd">@Json</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">Address</span><span class="o">(</span><span class="n">String</span> <span class="n">street</span><span class="o">,</span> <span class="n">String</span> <span class="n">suburb</span><span class="o">,</span> <span class="n">String</span> <span class="n">city</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
</pre></div>
</div>
<p>
All the fields of record types are set via constructor - no setters here.
<br><br>
When a class has a constructor like the City example below, then fields in the constructor do not need or use a setter method. We only need a setter method for fields that are not in the constructor.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">City</span> <span class="o">{</span>
  <span class="n">UUID</span> <span class="n">id</span><span class="o">;</span>
  <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
  <span class="n">String</span> <span class="n">zone</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">City</span><span class="o">(</span><span class="n">UUID</span> <span class="n">id</span><span class="o">,</span> <span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nf">setZone</span><span class="o">(</span><span class="n">String</span> <span class="n">zone</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">zone</span> <span class="o">=</span> <span class="n">zone</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="c1">// plus getters ...</span>
<span class="o">}</span>
</pre></div>
</div>

<p>
  In the example above the id and name fields are set via constructor
  and only zone is set via setter method.
</p>

<h4>Setter methods</h4>
<p>
  Fields that are not set via the constructor need to have a setter methods. There are 4 styles of setter methods that avaje-jsonb-generator will find.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">// traditional setter</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSuburb</span><span class="o">(</span><span class="n">String</span> <span class="n">suburb</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">this</span><span class="o">.</span><span class="na">suburb</span> <span class="o">=</span> <span class="n">suburb</span><span class="o">;</span>
<span class="o">}</span>
<span class="c1">// accessor style setter</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">suburb</span><span class="o">(</span><span class="n">String</span> <span class="n">suburb</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">this</span><span class="o">.</span><span class="na">suburb</span> <span class="o">=</span> <span class="n">suburb</span><span class="o">;</span>
<span class="o">}</span>
<span class="c1">// fluid traditional setter</span>
<span class="kd">public</span> <span class="n">Address</span> <span class="nf">setSuburb</span><span class="o">(</span><span class="n">String</span> <span class="n">suburb</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">this</span><span class="o">.</span><span class="na">suburb</span> <span class="o">=</span> <span class="n">suburb</span><span class="o">;</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
<span class="o">}</span>
<span class="c1">// fluid accessor style setter</span>
<span class="kd">public</span> <span class="n">Address</span> <span class="nf">suburb</span><span class="o">(</span><span class="n">String</span> <span class="n">suburb</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">this</span><span class="o">.</span><span class="na">suburb</span> <span class="o">=</span> <span class="n">suburb</span><span class="o">;</span>
  <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>

<h4>Naming Convention</h4>
<p>
  We can specify a naming convention via the naming attribute of <code>@Json</code>.
  This naming convention translates field names to json property names.
  The result of changing the naming convention can be seen in the generated JsonAdapter code.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span><span class="o">(</span><span class="nx">naming</span> <span class="o">=</span> <span class="nx">LowerHyphen</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Customer</span> <span class="o">{</span>
<span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">//The Naming options are below with the default of Match.</span>
<span class="kd">enum</span> <span class="n">Naming</span> <span class="o">{</span>
  <span class="n">Match</span><span class="o">,</span>
  <span class="n">LowerHyphen</span><span class="o">,</span>
  <span class="n">LowerUnderscore</span><span class="o">,</span>
  <span class="n">LowerSpace</span><span class="o">,</span>
  <span class="n">UpperCamel</span><span class="o">,</span>
  <span class="n">UpperHyphen</span><span class="o">,</span>
  <span class="n">UpperUnderscore</span><span class="o">,</span>
  <span class="n">UpperSpace</span>
<span class="o">}</span>
</pre></div>
</div>

<h3 id="adapter">Generated JsonAdapter</h3>
<p>Given the class:</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Address</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">street</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">City</span> <span class="n">city</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">Suburb</span> <span class="n">suburb</span><span class="o">;</span>
  <span class="c1">//getters/setters ommited for brevity</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The following JsonAdapter is generated:</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Generated</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">AddressJsonAdapter</span> <span class="kd">implements</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">Address</span><span class="o">&gt;,</span> <span class="n">ViewBuilderAware</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">final</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">stringJsonAdapter</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">City</span><span class="o">&gt;</span> <span class="n">cityJsonAdapter</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">Suburb</span><span class="o">&gt;</span> <span class="n">suburbJsonAdapter</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">PropertyNames</span> <span class="n">names</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">AddressJsonAdapter</span><span class="o">(</span><span class="n">Jsonb</span> <span class="n">jsonb</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">stringJsonAdapter</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">adapter</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">cityJsonAdapter</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">adapter</span><span class="o">(</span><span class="n">City</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">suburbJsonAdapter</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">adapter</span><span class="o">(</span><span class="n">Suburb</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">names</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">properties</span><span class="o">(</span><span class="s">&quot;street&quot;</span><span class="o">,</span> <span class="s">&quot;city&quot;</span><span class="o">,</span> <span class="s">&quot;suburb&quot;</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isViewBuilderAware</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">ViewBuilderAware</span> <span class="nf">viewBuild</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">build</span><span class="o">(</span><span class="n">ViewBuilder</span> <span class="n">builder</span><span class="o">,</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">MethodHandle</span> <span class="n">handle</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">builder</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">handle</span><span class="o">);</span>
    <span class="n">builder</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;street&quot;</span><span class="o">,</span> <span class="n">stringJsonAdapter</span><span class="o">,</span> <span class="n">builder</span><span class="o">.</span><span class="na">method</span><span class="o">(</span><span class="n">Address</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">&quot;getStreet&quot;</span><span class="o">,</span> <span class="n">java</span><span class="o">.</span><span class="na field">lang</span><span class="o">.</span><span class="na field">String</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="n">builder</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;city&quot;</span><span class="o">,</span> <span class="n">cityJsonAdapter</span><span class="o">,</span> <span class="n">builder</span><span class="o">.</span><span class="na">method</span><span class="o">(</span><span class="n">Address</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">&quot;getCity&quot;</span><span class="o">,</span> <span class="n">City</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="n">builder</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;suburb&quot;</span><span class="o">,</span> <span class="n">suburbJsonAdapter</span><span class="o">,</span> <span class="n">builder</span><span class="o">.</span><span class="na">method</span><span class="o">(</span><span class="n">Address</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">&quot;getSuburb&quot;</span><span class="o">,</span> <span class="n">Suburb</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="n">builder</span><span class="o">.</span><span class="na">endObject</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">toJson</span><span class="o">(</span><span class="n">JsonWriter</span> <span class="n">writer</span><span class="o">,</span> <span class="n">Address</span> <span class="n">address</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">address</span><span class="o">.</span><span class="na">getStreet</span><span class="o">());</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="n">cityJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">address</span><span class="o">.</span><span class="na">getCity</span><span class="o">());</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
    <span class="n">suburbJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">address</span><span class="o">.</span><span class="na">getSuburb</span><span class="o">());</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">endObject</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Address</span> <span class="nf">fromJson</span><span class="o">(</span><span class="n">JsonReader</span> <span class="n">reader</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Address</span> <span class="n">_&#36;address</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Address</span><span class="o">();</span>

    <span class="c1">// read json</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">reader</span><span class="o">.</span><span class="na">hasNextField</span><span class="o">())</span> <span class="o">{</span>
      <span class="kd">final</span> <span class="n">String</span> <span class="n">fieldName</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">nextField</span><span class="o">();</span>
      <span class="k">switch</span> <span class="o">(</span><span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="s">&quot;street&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">_&#36;address</span><span class="o">.</span><span class="na">setStreet</span><span class="o">(</span><span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">));</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">case</span> <span class="s">&quot;city&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">_&#36;address</span><span class="o">.</span><span class="na">setCity</span><span class="o">(</span><span class="n">cityJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">));</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">case</span> <span class="s">&quot;suburb&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">_&#36;address</span><span class="o">.</span><span class="na">setSuburb</span><span class="o">(</span><span class="n">suburbJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">));</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">default</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">unmappedField</span><span class="o">(</span><span class="n">fieldName</span><span class="o">);</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">skipValue</span><span class="o">();</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">endObject</span><span class="o">();</span>

    <span class="k">return</span> <span class="n">_&#36;address</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

<h2 id="import">@Json.Import</h2>
<p> When we are unable to or do not wish to put <code>@Json</code> on the types we can use <code>@Json.Import</code>.
<br><br>
We can put <code>@Json.Import</code> on a package or type and specify the types to generate a JsonAdapter for.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json.Import</span><span class="o">({</span><span class="nx">Customer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nx">Address</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nx">Order</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="kn">package</span> <span class="nn">org.example</span><span class="o">;</span>
</pre></div>
</div>

<h2 id="raw">@Json.Raw</h2>
<p>
We can use <code>@Json.Raw</code> to mark a String field as containing raw JSON content. This is then read and written (as a string containing raw json).
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json.Raw</span>
<span class="n">String</span> <span class="n">rawJson</span>
</pre></div>
</div>

<h2 id="property">@Json.Property</h2>
<p>
We can override the serialization/deserialization name of a field using <code>@Json.Property</code>.
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Customer</span> <span class="o">{</span>

  <span class="nd">@Json.Property</span><span class="o">(</span><span class="s">&quot;SomeOtherName&quot;</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">name</span>
  <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>

<p>
  Effectively, we have renamed this property and will not be able to deserialize this from a json of <code>{"name":"Jolyne"}</code>.
  It will now only deserialize for the new name. <code>{"SomeOtherName":"Jolyne"}</code>.
  <br>If you wish to only specify an alias for the json property, use <code>@Alias</code>.
</p>

<h4>Generated Code</h4>

<p><code>@Json.Property</code> makes the following changes to the generated JsonAdapter:</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Generated</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">CustomerJsonAdapter</span> <span class="kd">implements</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">Customer</span><span class="o">&gt;,</span> <span class="n">ViewBuilderAware</span> <span class="o">{</span>

  <span class="o">...</span>

  <span class="kd">public</span> <span class="nf">CustomerJsonAdapter</span><span class="o">(</span><span class="n">Jsonb</span> <span class="n">jsonb</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">stringJsonAdapter</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">adapter</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="c1">//observe how the property has been renamed from &quot;name&quot; to &quot;SomeOtherName&quot;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">names</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">properties</span><span class="o">(</span><span class="s">&quot;SomeOtherName&quot;</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="o">...</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Customer</span> <span class="nf">fromJson</span><span class="o">(</span><span class="n">JsonReader</span> <span class="n">reader</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Customer</span> <span class="n">_&#36;customer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="o">();</span>

    <span class="c1">// read json</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">reader</span><span class="o">.</span><span class="na">hasNextField</span><span class="o">())</span> <span class="o">{</span>
      <span class="kd">final</span> <span class="n">String</span> <span class="n">fieldName</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">nextField</span><span class="o">();</span>
      <span class="k">switch</span> <span class="o">(</span><span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//observe how the property has been renamed from &quot;name&quot; to &quot;SomeOtherName&quot;</span>
        <span class="k">case</span> <span class="s">&quot;SomeOtherName&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">_&#36;customer</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">));</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">default</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">unmappedField</span><span class="o">(</span><span class="n">fieldName</span><span class="o">);</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">skipValue</span><span class="o">();</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">_&#36;customer</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

<h2 id="alias">@Json.Alias</h2>

<p>
  We can define a deserialization alias for a field using <code>@Json.Alias</code>. It is compatible with, and can work in tandem with <code>@Property</code>
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Customer</span> <span class="o">{</span>

  <span class="nd">@Alias</span><span class="o">({</span><span class="s">&quot;SomeOtherName&quot;</span><span class="o">,</span><span class="s">&quot;SomeOtherName2&quot;</span><span class="o">})</span>
  <span class="kd">private</span> <span class="n">name</span>
  <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>

<h4>Generated Code</h4>

<p><code>@Json.Alias</code> makes the following changes to the generated JsonAdapter:</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Generated</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">CustomerJsonAdapter</span> <span class="kd">implements</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">Customer</span><span class="o">&gt;,</span> <span class="n">ViewBuilderAware</span> <span class="o">{</span>

  <span class="o">...</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Customer</span> <span class="nf">fromJson</span><span class="o">(</span><span class="n">JsonReader</span> <span class="n">reader</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Customer</span> <span class="n">_&#36;customer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Customer</span><span class="o">();</span>

    <span class="c1">// read json</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">reader</span><span class="o">.</span><span class="na">hasNextField</span><span class="o">())</span> <span class="o">{</span>
      <span class="kd">final</span> <span class="n">String</span> <span class="n">fieldName</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">nextField</span><span class="o">();</span>
      <span class="k">switch</span> <span class="o">(</span><span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//observe how the alias property names have been added to the switch</span>
        <span class="k">case</span> <span class="s">&quot;SomeOtherName&quot;</span><span class="o">:</span>
        <span class="k">case</span> <span class="s">&quot;SomeOtherName2&quot;</span><span class="o">:</span>
        <span class="k">case</span> <span class="s">&quot;name&quot;</span><span class="o">:</span> <span class="o">{</span> <span class="o">{</span>
          <span class="n">_&#36;customer</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">));</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">default</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">unmappedField</span><span class="o">(</span><span class="n">fieldName</span><span class="o">);</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">skipValue</span><span class="o">();</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">_&#36;customer</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>


<h2 id="iggy">@Json.Ignore</h2>
<p>
  We can exclude a field from json serialisation using @Json.Ignore
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Secrets</span> <span class="o">{</span>

  <span class="nd">@Json.Ignore</span> <span class="kd">private</span> <span class="nx">String</span> <span class="nx">mySecret</span><span class="o">;</span>

  <span class="c1">// Exclude from de-serialization only</span>
  <span class="nd">@Json.Ignore</span><span class="o">(</span><span class="nx">serialize</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">mySecret2</span><span class="o">;</span>

  <span class="c1">// Exclude from serialization only</span>
  <span class="nd">@Json.Ignore</span><span class="o">(</span><span class="nx">deserialize</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">mySecret3</span><span class="o">;</span>

  <span class="c1">//ommited getters/setters</span>
<span class="o">}</span>
</pre></div>
</div>

<h4>Generated Code</h4>

<p><code>@Json.Ignore</code> makes the following changes to the generated JsonAdapter:</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Generated</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">SecretsJsonAdapter</span> <span class="kd">implements</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">Secrets</span><span class="o">&gt;,</span> <span class="n">ViewBuilderAware</span> <span class="o">{</span>

  <span class="o">...</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">toJson</span><span class="o">(</span><span class="n">JsonWriter</span> <span class="n">writer</span><span class="o">,</span> <span class="n">Secrets</span> <span class="n">secrets</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
    <span class="c1">//only mySecret2 is serialized</span>
    <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">secrets</span><span class="o">.</span><span class="na">getMySecret2</span><span class="o">());</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">endObject</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Secrets</span> <span class="nf">fromJson</span><span class="o">(</span><span class="n">JsonReader</span> <span class="n">reader</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Secrets</span> <span class="n">_&#36;secrets</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Secrets</span><span class="o">();</span>

    <span class="c1">// read json</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">reader</span><span class="o">.</span><span class="na">hasNextField</span><span class="o">())</span> <span class="o">{</span>
      <span class="kd">final</span> <span class="n">String</span> <span class="n">fieldName</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">nextField</span><span class="o">();</span>
      <span class="k">switch</span> <span class="o">(</span><span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="s">&quot;mySecret&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="c1">//skips deserializing ignored fields</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">skipValue</span><span class="o">();</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">case</span> <span class="s">&quot;mySecret2&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">skipValue</span><span class="o">();</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">case</span> <span class="s">&quot;mySecret3&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="c1">//mySecret3 is the only field to get deserialized</span>
          <span class="n">_&#36;secrets</span><span class="o">.</span><span class="na">setMySecret3</span><span class="o">(</span><span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">));</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">default</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">unmappedField</span><span class="o">(</span><span class="n">fieldName</span><span class="o">);</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">skipValue</span><span class="o">();</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">endObject</span><span class="o">();</span>

    <span class="k">return</span> <span class="n">_&#36;secrets</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>


<h2 id="mapped">@Json.Unmapped</h2>
<p>
We can use <code>@Json.Unmapped</code> to collect unmapped json during de-serialization and include it in serialization.
<br></br>
The @Json.Unmapped annotation must be on a field of type <code>Map<String, Object></code>
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UnmappedJson</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">mapped</span><span class="o">;</span>
  <span class="nd">@Json.Unmapped</span> <span class="kd">private</span> <span class="nx">Map</span><span class="o">&lt;</span><span class="nx">String</span><span class="o">,</span> <span class="nx">Object</span><span class="o">&gt;</span> <span class="nx">unmapped</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>

<h4>Generated Code</h4>

<p><code>@Json.Unmapped</code> makes the following changes to the generated JsonAdapter:</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Generated</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">UnmappedJsonJsonAdapter</span> <span class="kd">implements</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">UnmappedJson</span><span class="o">&gt;,</span> <span class="n">ViewBuilderAware</span> <span class="o">{</span>

  <span class="o">...</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">toJson</span><span class="o">(</span><span class="n">JsonWriter</span> <span class="n">writer</span><span class="o">,</span> <span class="n">UnmappedJson</span> <span class="n">unmappedJson</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">names</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">unmappedJson</span><span class="o">.</span><span class="na">getMapped</span><span class="o">());</span>
    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">unmapped</span> <span class="o">=</span> <span class="n">unmappedJson</span><span class="o">.</span><span class="na">getUnmapped</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">unmapped</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
     <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">unmapped</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
       <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
       <span class="n">objectJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
     <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">endObject</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">UnmappedJson</span> <span class="nf">fromJson</span><span class="o">(</span><span class="n">JsonReader</span> <span class="n">reader</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">UnmappedJson</span> <span class="n">_&#36;unmappedJson</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UnmappedJson</span><span class="o">();</span>
    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">unmapped</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedHashMap</span><span class="o">&lt;&gt;();</span>

    <span class="c1">// read json</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">reader</span><span class="o">.</span><span class="na">hasNextField</span><span class="o">())</span> <span class="o">{</span>
      <span class="kd">final</span> <span class="n">String</span> <span class="n">fieldName</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">nextField</span><span class="o">();</span>
      <span class="k">switch</span> <span class="o">(</span><span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="s">&quot;mapped&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">_&#36;unmappedJson</span><span class="o">.</span><span class="na">setMapped</span><span class="o">(</span><span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">));</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">default</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">Object</span> <span class="n">value</span> <span class="o">=</span> <span class="n">objectJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">);</span>
          <span class="n">unmapped</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">fieldName</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">endObject</span><span class="o">();</span>

   <span class="c1">// unmappedField...</span>
    <span class="n">_&#36;unmappedJson</span><span class="o">.</span><span class="na">setUnmapped</span><span class="o">(</span><span class="n">unmapped</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">_&#36;unmappedJson</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

<h2 id="value">Enum Mapping with @Json.Value</h2>

<p>
We can use <code>@Json.Value</code> on Enum types to specify a method that provides the values that will be used to serialize to/from json. This works for any type that can be compared with <code>.equals()</code>
<br></br>
In the example below the values used in the json content is "one value" and "two value" rather than the usual "ONE" and "TWO".
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">enum</span> <span class="n">MyEnum</span> <span class="o">{</span>

  <span class="n">ONE</span><span class="o">(</span><span class="s">&quot;one value&quot;</span><span class="o">),</span>
  <span class="n">TWO</span><span class="o">(</span><span class="s">&quot;two value&quot;</span><span class="o">);</span>

  <span class="kd">final</span> <span class="n">String</span> <span class="k">val</span><span class="o">;</span>

  <span class="n">MyEnum</span><span class="o">(</span><span class="n">String</span> <span class="k">val</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">val</span> <span class="o">=</span> <span class="k">val</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Json.Value</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">value</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">val</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

<h4>Generated Code</h4>

<p>A specialized adapter is generated to handle the enum mapping</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Generated</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">MyEnumJsonAdapter</span> <span class="kd">implements</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">MyEnum</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">MyEnum</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">toValue</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EnumMap</span><span class="o">&lt;&gt;(</span><span class="n">MyEnum</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">MyEnum</span><span class="o">&gt;</span> <span class="n">toEnum</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">adapter</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">MyEnumJsonAdapter</span><span class="o">(</span><span class="n">Jsonb</span> <span class="n">jsonb</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">adapter</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">adapter</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="k">if</span><span class="o">(!</span><span class="n">toValue</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="k">return</span><span class="o">;</span>
    <span class="k">for</span><span class="o">(</span><span class="kd">final</span> <span class="k">var</span> <span class="n">enumConst</span> <span class="o">:</span> <span class="n">MyEnum</span><span class="o">.</span><span class="na">values</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">var</span> <span class="k">val</span> <span class="o">=</span> <span class="n">enumConst</span><span class="o">.</span><span class="na">getCode</span><span class="o">();</span>
      <span class="n">toValue</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">enumConst</span><span class="o">,</span> <span class="k">val</span><span class="o">);</span>
      <span class="k">if</span><span class="o">(</span><span class="n">toEnum</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="k">val</span><span class="o">))</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="s">&quot;Duplicate value &quot;</span><span class="o">+</span> <span class="k">val</span> <span class="o">+</span> <span class="s">&quot; from enum method value. @Json.Value methods must return unique values&quot;</span><span class="o">);</span>
      <span class="n">toEnum</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="k">val</span><span class="o">,</span> <span class="n">enumConst</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">toJson</span><span class="o">(</span><span class="n">JsonWriter</span> <span class="n">writer</span><span class="o">,</span> <span class="n">MyEnum</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">adapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">toValue</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">value</span><span class="o">));</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">MyEnum</span> <span class="nf">fromJson</span><span class="o">(</span><span class="n">JsonReader</span> <span class="n">reader</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="k">var</span> <span class="n">value</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">);</span>
    <span class="kd">final</span> <span class="k">var</span> <span class="n">enumConstant</span> <span class="o">=</span> <span class="n">toEnum</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">enumConstant</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">JsonDataException</span><span class="o">(</span><span class="s">&quot;Unable to determine MyEnum enum value for &quot;</span> <span class="o">+</span> <span class="n">value</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">enumConstant</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

<h2 id="mixin">@Json.Mixin</h2>

<p>
  Mark this Class as a MixIn Type that can add Jsonb Annotations on the specified type.
  <br>
  Say we want to override the field serialization behavior on a class we can't modify.(Typically in an external project/dependency or otherwise)
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MixinTarget</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">stand</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">bandReference</span><span class="o">;</span>
  <span class="c1">//getters/setters...</span>
<span class="o">}</span>
</pre></div>
</div>
<p>We can use the <code>@Json.Mixin</code> annotation on an abstract class to effectively add @Json Annotations </p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json.MixIn</span><span class="o">(</span><span class="nx">MixinTarget</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">MixinClass</span> <span class="o">{</span>

  <span class="nd">@Json.Property</span><span class="o">(</span><span class="s">&quot;part&quot;</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

  <span class="nd">@Json.Ignore</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">stand</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>

<h4>Generated Code</h4>

<p><code>@Json.Mixin</code> makes the following changes to the generated MixinTargetJsonAdapter:</p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Generated</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">MixinTargetJsonAdapter</span> <span class="kd">implements</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">MixinTarget</span><span class="o">&gt;,</span> <span class="n">ViewBuilderAware</span> <span class="o">{</span>

  <span class="o">...</span>
  <span class="kd">public</span> <span class="nf">MixinTargetJsonAdapter</span><span class="o">(</span><span class="n">Jsonb</span> <span class="n">jsonb</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">stringJsonAdapter</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">adapter</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="c1">//the mixin class renamed &quot;name&quot; property to &quot;part&quot;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">names</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">properties</span><span class="o">(</span><span class="s">&quot;part&quot;</span><span class="o">,</span> <span class="s">&quot;stand&quot;</span><span class="o">,</span> <span class="s">&quot;bandReference&quot;</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="o">...</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">toJson</span><span class="o">(</span><span class="n">JsonWriter</span> <span class="n">writer</span><span class="o">,</span> <span class="n">MixinTarget</span> <span class="n">mixinTarget</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
    <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">mixinTarget</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
    <span class="c1">// stand property is absent</span>
    <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">mixinTarget</span><span class="o">.</span><span class="na">getBandReference</span><span class="o">());</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">endObject</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">MixinTarget</span> <span class="nf">fromJson</span><span class="o">(</span><span class="n">JsonReader</span> <span class="n">reader</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">MixinTarget</span> <span class="n">_&#36;mixinTarget</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MixinTarget</span><span class="o">();</span>

    <span class="c1">// read json</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">reader</span><span class="o">.</span><span class="na">hasNextField</span><span class="o">())</span> <span class="o">{</span>
      <span class="kd">final</span> <span class="n">String</span> <span class="n">fieldName</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">nextField</span><span class="o">();</span>
      <span class="k">switch</span> <span class="o">(</span><span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="s">&quot;part&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">_&#36;mixinTarget</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">));</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">case</span> <span class="s">&quot;stand&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="c1">//now ignored</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">skipValue</span><span class="o">();</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">case</span> <span class="s">&quot;bandReference&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">_&#36;mixinTarget</span><span class="o">.</span><span class="na">setBandReference</span><span class="o">(</span><span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">));</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">default</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">unmappedField</span><span class="o">(</span><span class="n">fieldName</span><span class="o">);</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">skipValue</span><span class="o">();</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">endObject</span><span class="o">();</span>

    <span class="k">return</span> <span class="n">_&#36;mixinTarget</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

<h2 id="subtype">@Json.Subtype</h2>

<p>For mapping polymorphic types we specify on the parent type a <code>@Json.Subtype</code> for each concrete sub-type that can represent that type.

<p>By default the "type property" that specifies the type in json is <code>"@type"</code>. Use <code>@Json(typeProperty=...)</code> to specify the name of the type property.</p>

Note: There is a current limitation that polymorphic types do not yet support "Json Views".</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span>
<span class="nd">@Json.SubType</span><span class="o">(</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">Car</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="s">&quot;CAR&quot;</span><span class="o">)</span>
<span class="nd">@Json.SubType</span><span class="o">(</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">Truck</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="s">&quot;TRUCK&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Vehicle</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">engine</span><span class="o">;</span>
  <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>

  <p>If desired, you can define the type parameter yourself for your own use.</p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span><span class="o">(</span><span class="nx">typeProperty</span><span class="o">=</span><span class="s">&quot;type&quot;</span><span class="o">)</span>
<span class="nd">@Json.SubType</span><span class="o">(</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">Car</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="s">&quot;CAR&quot;</span><span class="o">)</span>
<span class="nd">@Json.SubType</span><span class="o">(</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">Truck</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="s">&quot;TRUCK&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Vehicle</span> <span class="o">{</span>
  <span class="c1">//can use getters/setters on the typeProperty</span>
  <span class="c1">//the value will be for deserialization only</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">type</span><span class="o">;</span>
  <span class="o">...</span>
<span class="o">}</span>
<span class="c1">//For interfaces, the typeProperty needs to be defined in the subClasses</span>
</pre></div>
</div>

   <p>Additionally, you can deserialize the typeProperty to an enum.</p>

   <div class="syntax java"><div class="highlight"><pre><span></span><span class="kd">enum</span> <span class="n">TypeEnum</span> <span class="o">{</span>
  <span class="n">CAR</span><span class="o">,</span>
  <span class="n">TRUCK</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Json</span><span class="o">(</span><span class="nx">typeProperty</span><span class="o">=</span><span class="s">&quot;type&quot;</span><span class="o">)</span>
<span class="c1">//the subType names must correspond to an enum constant</span>
<span class="nd">@Json.SubType</span><span class="o">(</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">Car</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="s">&quot;CAR&quot;</span><span class="o">)</span>
<span class="nd">@Json.SubType</span><span class="o">(</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">Truck</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="s">&quot;TRUCK&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Vehicle</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">TypeEnum</span> <span class="n">type</span><span class="o">;</span>
  <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>

  <h4>Generated Code</h4>

  <p>Given this class:</p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Json</span>
<span class="nd">@Json.SubType</span><span class="o">(</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">Car</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@Json.SubType</span><span class="o">(</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">Truck</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="s">&quot;TRUCK&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Vehicle</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">engine</span><span class="o">;</span>
  <span class="o">...</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="kd">extends</span> <span class="n">Vehicle</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">carField</span><span class="o">;</span>
  <span class="o">...</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Truck</span> <span class="kd">extends</span> <span class="n">Vehicle</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">truckfield</span><span class="o">;</span>
  <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>

  <p>The below adapter will be generated:</p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Generated</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">VehicleJsonAdapter</span> <span class="kd">implements</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">Vehicle</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">final</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">stringJsonAdapter</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">PropertyNames</span> <span class="n">names</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">VehicleJsonAdapter</span><span class="o">(</span><span class="n">Jsonb</span> <span class="n">jsonb</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">stringJsonAdapter</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">adapter</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="c1">//all the propertynames of the subclasses are included</span>
    <span class="k">this</span><span class="o">.</span><span class="na">names</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">properties</span><span class="o">(</span><span class="s">&quot;@type&quot;</span><span class="o">,</span> <span class="s">&quot;engine&quot;</span><span class="o">,</span> <span class="s">&quot;carField&quot;</span><span class="o">,</span> <span class="s">&quot;truckfield&quot;</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">toJson</span><span class="o">(</span><span class="n">JsonWriter</span> <span class="n">writer</span><span class="o">,</span> <span class="n">Vehicle</span> <span class="n">vehicle</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">vehicle</span> <span class="k">instanceof</span> <span class="n">Car</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Car</span> <span class="n">sub</span> <span class="o">=</span> <span class="o">(</span><span class="n">Car</span><span class="o">)</span> <span class="n">vehicle</span><span class="o">;</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
      <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="s">&quot;Car&quot;</span><span class="o">);</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
      <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">sub</span><span class="o">.</span><span class="na">getEngine</span><span class="o">());</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
      <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">sub</span><span class="o">.</span><span class="na">getCarField</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">vehicle</span> <span class="k">instanceof</span> <span class="n">Truck</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Truck</span> <span class="n">sub</span> <span class="o">=</span> <span class="o">(</span><span class="n">Truck</span><span class="o">)</span> <span class="n">vehicle</span><span class="o">;</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
      <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="s">&quot;TRUCK&quot;</span><span class="o">);</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
      <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">sub</span><span class="o">.</span><span class="na">getEngine</span><span class="o">());</span>
      <span class="n">writer</span><span class="o">.</span><span class="na">name</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
      <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">writer</span><span class="o">,</span> <span class="n">sub</span><span class="o">.</span><span class="na">getTruckfield</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="n">writer</span><span class="o">.</span><span class="na">endObject</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Vehicle</span> <span class="nf">fromJson</span><span class="o">(</span><span class="n">JsonReader</span> <span class="n">reader</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// variables to read json values into, constructor params don&#39;t need _set&#36; flags</span>
    <span class="n">String</span>     <span class="n">_val&#36;engine</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="kt">boolean</span> <span class="n">_set&#36;engine</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="n">String</span>     <span class="n">_val&#36;carField</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="kt">boolean</span> <span class="n">_set&#36;carField</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="n">String</span>     <span class="n">_val&#36;truckfield</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="kt">boolean</span> <span class="n">_set&#36;truckfield</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

    <span class="n">String</span> <span class="n">type</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="c1">// read json</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">beginObject</span><span class="o">(</span><span class="n">names</span><span class="o">);</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">reader</span><span class="o">.</span><span class="na">hasNextField</span><span class="o">())</span> <span class="o">{</span>
      <span class="kd">final</span> <span class="n">String</span> <span class="n">fieldName</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">nextField</span><span class="o">();</span>
      <span class="k">switch</span> <span class="o">(</span><span class="n">fieldName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="s">&quot;@type&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">type</span> <span class="o">=</span> <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">);</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">case</span> <span class="s">&quot;engine&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">_val&#36;engine</span> <span class="o">=</span> <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">);</span> <span class="n">_set&#36;engine</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">case</span> <span class="s">&quot;carField&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">_val&#36;carField</span> <span class="o">=</span> <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">);</span> <span class="n">_set&#36;carField</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">case</span> <span class="s">&quot;truckfield&quot;</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">_val&#36;truckfield</span> <span class="o">=</span> <span class="n">stringJsonAdapter</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">reader</span><span class="o">);</span> <span class="n">_set&#36;truckfield</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span> <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">default</span><span class="o">:</span> <span class="o">{</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">unmappedField</span><span class="o">(</span><span class="n">fieldName</span><span class="o">);</span>
          <span class="n">reader</span><span class="o">.</span><span class="na">skipValue</span><span class="o">();</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">reader</span><span class="o">.</span><span class="na">endObject</span><span class="o">();</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">type</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalStateException</span><span class="o">(</span><span class="s">&quot;Missing @type property which is required?&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="s">&quot;Car&quot;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">type</span><span class="o">))</span> <span class="o">{</span>
      <span class="n">Car</span> <span class="n">_&#36;vehicle</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Car</span><span class="o">();</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">_set&#36;engine</span><span class="o">)</span> <span class="n">_&#36;vehicle</span><span class="o">.</span><span class="na">setEngine</span><span class="o">(</span><span class="n">_val&#36;engine</span><span class="o">);</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">_set&#36;carField</span><span class="o">)</span> <span class="n">_&#36;vehicle</span><span class="o">.</span><span class="na">setCarField</span><span class="o">(</span><span class="n">_val&#36;carField</span><span class="o">);</span>
      <span class="k">return</span> <span class="n">_&#36;vehicle</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="s">&quot;TRUCK&quot;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">type</span><span class="o">))</span> <span class="o">{</span>
      <span class="n">Truck</span> <span class="n">_&#36;vehicle</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Truck</span><span class="o">();</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">_set&#36;engine</span><span class="o">)</span> <span class="n">_&#36;vehicle</span><span class="o">.</span><span class="na">setEngine</span><span class="o">(</span><span class="n">_val&#36;engine</span><span class="o">);</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">_set&#36;truckfield</span><span class="o">)</span> <span class="n">_&#36;vehicle</span><span class="o">.</span><span class="na">setTruckfield</span><span class="o">(</span><span class="n">_val&#36;truckfield</span><span class="o">);</span>
      <span class="k">return</span> <span class="n">_&#36;vehicle</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalStateException</span><span class="o">(</span><span class="s">&quot;Unknown value for @type property &quot;</span> <span class="o">+</span> <span class="n">type</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

<h2 id="custom">@CustomAdapter</h2>
<p>
  With <code>@CustomAdapter</code>, you can define your own JsonAdapter for your more esoteric serialization needs.
  A custom adapter registered using this annotation must have a public constructor accepting a Jsonb instance (or a <code>public static JsonAdapter.Factory FACTORY</code> field for generic adapters), and must directly implement the JsonAdapter Interface.
</p>

<h4>Standard Adapters</h4>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@CustomAdapter</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomClassJsonAdapter</span> <span class="kd">implements</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">CustomClass</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">final</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">stringJsonAdapter</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">PropertyNames</span> <span class="n">names</span><span class="o">;</span>

  <span class="c1">//a public construtor accepting Jsonb is required</span>
  <span class="kd">public</span> <span class="nf">CustomClassJsonAdapter</span><span class="o">(</span><span class="n">Jsonb</span> <span class="n">jsonb</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">//type adapters can be fetched using adapter</span>
    <span class="k">this</span><span class="o">.</span><span class="na">stringJsonAdapter</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">adapter</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="c1">//write the json field names</span>
    <span class="k">this</span><span class="o">.</span><span class="na">names</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">properties</span><span class="o">(</span><span class="s">&quot;body&quot;</span><span class="o">);</span>
  <span class="o">}</span>

 <span class="o">...</span> <span class="n">write</span> <span class="n">your</span> <span class="n">custom</span> <span class="n">serialization</span> <span class="n">logic</span>
<span class="o">}</span>
</pre></div>
</div>

<h4>Generic Adapters</h4>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@CustomAdapter</span><span class="o">(</span><span class="nx">isGeneric</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomGenericClassJsonAdapter</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">GenericClass</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">final</span> <span class="n">JsonAdapter</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">TAdapter</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">PropertyNames</span> <span class="n">names</span><span class="o">;</span>

  <span class="c1">// Required</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">JsonAdapter</span><span class="o">.</span><span class="na">Factory</span> <span class="n">FACTORY</span> <span class="o">=</span>
      <span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">jsonb</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">Types</span><span class="o">.</span><span class="na">isGenericTypeOf</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="n">GenericClass</span><span class="o">.</span><span class="na">class</span><span class="o">))</span> <span class="o">{</span>

          <span class="k">return</span> <span class="k">new</span> <span class="n">CustomGenericClassJsonAdapter</span><span class="o">&lt;&gt;(</span><span class="n">jsonb</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">typeArguments</span><span class="o">(</span><span class="n">type</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
      <span class="o">};</span>

  <span class="kd">public</span> <span class="nf">CustomGenericClassJsonAdapter</span><span class="o">(</span><span class="n">Jsonb</span> <span class="n">jsonb</span><span class="o">,</span> <span class="n">Type</span><span class="o">[]</span> <span class="n">types</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">TAdapter</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">adapter</span><span class="o">(</span><span class="n">types</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
    <span class="k">this</span><span class="o">.</span><span class="na">names</span> <span class="o">=</span> <span class="n">jsonb</span><span class="o">.</span><span class="na">properties</span><span class="o">(</span><span class="s">&quot;key&quot;</span><span class="o">,</span> <span class="s">&quot;val&quot;</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="o">...</span> <span class="n">write</span> <span class="n">your</span> <span class="n">custom</span> <span class="n">serialization</span> <span class="n">logic</span>
<span class="o">}</span>
</pre></div>
</div>


  </article>
</div>

<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="/js/site.js"></script>
</body>
</html>
