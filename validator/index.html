<!doctype html>
<html lang="en">
<head>
  <title>Avaje</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" href="/images/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Source+Sans+Pro|Ubuntu&display=swap">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/reset.css">
  <link rel="stylesheet" href="/css/site.css">
  <link rel="stylesheet" href="/css/pygments.css">
</head>
<body>

<div class="container">
  <aside id="sidenav">
    <nav class="side scroll">
<ul>
  <li><a href="#overview">Overview</a>
</li>
<li><a href="#requires">Requirements</a>
</li>
<li><a href="#quick-start">Quick Start</a>
</li>
<li><a href="#jpms">Java Modules</a>
</li>
<li><a href="#integration">Avaje/Spring Integration</a>
</li>
<li><a href="#boot">Customizer</a>
</li>
<li><a href="#configuration">Configuration</a>
    <ul>
      <li><a href="#locales">Locales</a></li>
      <li><a href="#supportedLocales">Supported Locales</a></li>
      <li><a href="#additionalResourceBundles">Message bundles</a></li>
    </ul>
</li>

<li><a href="#constraint">Declaring Bean Constraints</a>
    <ul>
      <li><a href="#field">Field Validation</a></li>
      <li><a href="#getter">Getter Validation</a></li>
      <li><a href="#container">Container Constraints</a></li>
      <li><a href="#classlvl">Class-Level Constraints</a></li>
      <li><a href="#cascade">Cascaded Validation</a></li>
      <li><a href="#inherited">Inherited Constraints</a></li>
    </ul>
</li>
<li><a href="#mixin">@Mixin</a>
</li>
<li><a href="#methods">Method Validation</a>
</li>
<li><a href="#message">Constraint Error Message</a>
    <ul>
      <li><a href="#bundle">ResourceBundle Loading</a></li>
      <li><a href="#interpolation">Message Interpolation</a></li>
    </ul>
</li>
<li><a href="#groups">Grouping Constraints</a>
</li>
<li><a href="#custom">Custom Constraints</a>
    <ul>
      <li><a href="#constraints">@Constraint</a></li>
      <li><a href="#adapter">@ConstraintAdapter</a></li>
      <li><a href="#cross">@CrossParamContraint</a></li>
    </ul>
</li>
<li><a href="#composable">Composing Constraints</a>
</li>
</ul>
<p>&nbsp;</p>
    </nav>
  </aside>
  <article id="main-content">
    <header>
      <nav id="top">
        <div class="breadcrumb"><a href="/">avaje</a><span class="sep">&nbsp;/&nbsp;</span><span class="last">validator</span></div>
        <ul>
          <li><a href="/" title="home"><i class="fas fa-home"></i></a></li>
          <li><a href="https://discord.gg/Qcqf9R27BR" title="discord server"><i class="fab fa-discord"></i></a></li>
          <li><a href="https://github.com/avaje/avaje-validator" title="github source"><i class="fab fa-github"></i></a></li>
          <li><a onclick="toggleTheme();" title="switch dark light theme"><i class="fas fa-adjust"></i></a></li>
        </ul>
      </nav>
    </header>
    
  <h1 id="overview">Avaje Validator</h1>

  <table style="width: 100%;">
    <tr>
      <th>Discord</th>
      <th>Source</th>
      <th>API Docs</th>
      <th>Issues</th>
      <th>Releases</th>
    </tr>
    <tr>
      <td><a href="https://discord.gg/Qcqf9R27BR">Discord</td>
      <td><a target="_blank" href="https://github.com/avaje/avaje-validator">Github</a></td>
      <td><a target="_blank" href="https://javadoc.io/doc/io.avaje/avaje-validator">Javadoc</a></td>
      <td><a target="_blank" href="https://github.com/avaje/avaje-validator/issues">Github</a></td>
      <td><a href="https://github.com/avaje/avaje-validator/releases"><img
            src="https://img.shields.io/maven-central/v/io.avaje/avaje-validator.svg?label=Maven%20Central"></a></td>
    </tr>
  </table>

  <p><br><br>
    Reflection-free POJO validation via apt source code generation.
    A light (~120kb + generated code) source code generation style alternative to Hibernate Validation. (code generation
    vs reflection)
  </p>

  <ul>
    <li>Annotate java classes with <code>@Valid</code> (or use <code>@ImportValidPojo</code> for types we "don't own" or
      can't annotate)</li>
    <li>Supports Avaje/Jakarta/Javax Constraint Annotations</li>
    <li>Validation Group Support</li>
    <li>Composable Contraints</li>
    <li>Inherited Contraints</li>
    <li>Cascaded Validation</li>
    <li>Adding/Modify constraints on 3rd Party classes</li>
  </ul>

  <h2 id="requires">Requires Java 17+</h2>
  <p>
    Avaje Validator requires Java 17 or higher.
  </p>

  <h2 id="quick-start">Quick Start</h2>
  <h4>
    1. Add <em>avaje-validator</em> dependencies.
  </h4>
  <div class="syntax xml"><div class="highlight"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>io.avaje<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>avaje-validator<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>&#36;{avaje.validator.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="c">&lt;!-- Alternatively can use Jakarta/Javax Constraints--&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>io.avaje<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>avaje-validator-constraints<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>&#36;{avaje.validator.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="c">&lt;!-- If using spring:</span>
<span class="c">&lt;dependency&gt;</span>
<span class="c">  &lt;groupId&gt;io.avaje&lt;/groupId&gt;</span>
<span class="c">  &lt;artifactId&gt;avaje-validator-spring-starter&lt;/artifactId&gt;</span>
<span class="c">  &lt;version&gt;&#36;{avaje.validator.version}&lt;/version&gt;</span>
<span class="c">&lt;/dependency&gt;</span>
<span class="c">--&gt;</span>
</pre></div>
</div>

  <h4>
    2. Add the annotation processor to your pom.
  </h4>
  <div class="syntax xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- Annotation processors --&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>io.avaje<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>avaje-validator-generator<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>&#36;{avaje.validator.version}<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
  <span class="nt">&lt;optional&gt;</span>true<span class="nt">&lt;/optional&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>
</div>

  <h4>2a. JDK 23+</h4>

  <p>In JDK 23+, annotation processors are disabled by default, so we need to add a compiler property to re-enable.</p>

  <div class="syntax xml"><div class="highlight"><pre><span></span><span class="nt">&lt;properties&gt;</span>
  <span class="nt">&lt;maven.compiler.proc&gt;</span>full<span class="nt">&lt;/maven.compiler.proc&gt;</span>
<span class="nt">&lt;/properties&gt;</span>
</pre></div>
</div>

  <h4>3. Add <code>@Valid</code> onto types we want to serialize.</h4>
  <p>
    <br>The avaje-validator-generator annotation processor will generate a ValidationAdapter as java source code for
    each type annotated with <code>@Valid</code>.
    These will be automatically registered with validator using a service loader mechanism.
    <br><br>For types we cannot annotate with <code>@Valid</code> we can instead use <code>@ImportValidPojo</code> or <code>@Mixin</code> to modify validation behavior of external classes.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Valid</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Address</span> <span class="o">{</span>

  <span class="nd">@NotBlank</span> <span class="nd">@Size</span><span class="o">(</span><span class="nx">max</span> <span class="o">=</span> <span class="mi">100</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">street</span><span class="o">;</span>

  <span class="nd">@Size</span><span class="o">(</span><span class="nx">max</span> <span class="o">=</span> <span class="mi">80</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">suburb</span><span class="o">;</span>

  <span class="nd">@NotBlank</span> <span class="nd">@Size</span><span class="o">(</span><span class="nx">max</span> <span class="o">=</span> <span class="mi">80</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">city</span><span class="o">;</span>

  <span class="c1">// accessors/getters/setters etc</span>
<span class="o">}</span>
</pre></div>
</div>

  <p>Also works with records:</p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Valid</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">RingedCity</span><span class="o">(</span>
      <span class="nd">@NotBlank</span> <span class="nx">String</span> <span class="nx">street</span><span class="o">,</span>
      <span class="nx">List</span><span class="o">&lt;</span><span class="nd">@NotBlank</span> <span class="nx">String</span><span class="o">&gt;</span> <span class="nx">judges</span><span class="o">,</span>
      <span class="nd">@Valid</span> <span class="nd">@NotNull</span> <span class="nx">DarkEater</span> <span class="nx">dragon</span>
<span class="o">)</span> <span class="o">{}</span>
</pre></div>
</div>

  <h4>
    4. Validate your POJO
  </h4>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">// build using defaults</span>
<span class="n">Validator</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">Validator</span><span class="o">.</span><span class="na">builder</span><span class="o">().</span><span class="na">build</span><span class="o">();</span>

<span class="n">Customer</span> <span class="n">customer</span> <span class="o">=</span> <span class="o">...;</span>

<span class="c1">// will throw a `ConstraintViolationException` containing all the failed constraint violations</span>
<span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">customer</span><span class="o">);</span>

<span class="c1">// validate with explicit locale for error message lookup</span>
<span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">customer</span><span class="o">,</span> <span class="n">Locale</span><span class="o">.</span><span class="na">ENGLISH</span><span class="o">);</span>

<span class="c1">// validate with groups</span>
<span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">customer</span><span class="o">,</span> <span class="n">Locale</span><span class="o">.</span><span class="na">ENGLISH</span><span class="o">,</span> <span class="n">Group1</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>
</div>

  <h2 id="jpms">Java Module Setup</h2>
  <p>
    If using java modules, in the <code>module-info.java</code> we need to:
  </p>
  <ol>
    <li>Add a <em>requires</em> clause for <em>io.avaje.validator</em></li>
    <li>Add a <em>provides</em> clause for <em>io.avaje.validator.validator.GeneratedComponent</em></li>
  </ol>

  <h5>Example module-info</h5>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">io.avaje.validation.Validator.GeneratedComponent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.avaje.validation.spi.ValidationExtension</span><span class="o">;</span>

<span class="n">module</span> <span class="n">org</span><span class="o">.</span><span class="na">example</span> <span class="o">{</span>

  <span class="n">requires</span> <span class="n">io</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na">validator</span><span class="o">;</span>

  <span class="c1">// you must define the fully qualified class name of generated classes. If you use an import statement, compilation will fail</span>
  <span class="n">provides</span> <span class="n">ValidationExtension</span> <span class="n">with</span> <span class="n">org</span><span class="o">.</span><span class="na field">example</span><span class="o">.</span><span class="na field">validator</span><span class="o">.</span><span class="na">GeneratedComponent</span><span class="o">;</span>

  <span class="c1">//if running using jlink/jpackage application images with avaje-inject add:</span>
  <span class="c1">//requires io.avaje.validator.plugin;</span>

  <span class="c1">//if running using jlink/jpackage application images with both avaje-http and inject add:</span>
  <span class="c1">//requires io.avaje.validator.http;</span>
<span class="o">}</span>
</pre></div>
</div>
  <p>
    In the example above, <code>org.example.validator.GeneratedComponent</code> is generated code typically found in
    <code>target/generated-sources/annotations</code>.
  </p>

  <h2 id="integration">Avaje/Spring Integration</h2>
  <p>
    When used with Avaje Inject or the Spring Framework, a default <code>Validator</code> and <code>AOPMethodValidator</code> instance will be
    provided. The following properties can be added to configure the construction of the default instance.
  </p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="n">validation</span><span class="o">.</span><span class="na">failFast</span> <span class="c1">//enable fail fast mode</span>
<span class="n">validation</span><span class="o">.</span><span class="na field">resourcebundle</span><span class="o">.</span><span class="na">names</span> <span class="c1">// name of ResourceBundle files to load</span>
<span class="n">validation</span><span class="o">.</span><span class="na field">locale</span><span class="o">.</span><span class="na">default</span> <span class="c1">//default locale to use (defaults to Locale.getDefault())</span>
<span class="n">validation</span><span class="o">.</span><span class="na field">locale</span><span class="o">.</span><span class="na">addedLocales</span> <span class="c1">//Additional Locales this validator should support</span>
<span class="n">validation</span><span class="o">.</span><span class="na field">temporal</span><span class="o">.</span><span class="na field">tolerance</span><span class="o">.</span><span class="na">value</span> <span class="c1">//temporal tolerance value</span>
<span class="n">validation</span><span class="o">.</span><span class="na field">temporal</span><span class="o">.</span><span class="na field">tolerance</span><span class="o">.</span><span class="na">chronoUnit</span> <span class="c1">//What ChronoUnit enum value to use for temporal tolerance (default MILLIS)</span>
</pre></div>
</div>

  </p>

  <h2 id="boot">ValidatorCustomizer</h2>
  <p>
    We can create a class that implements <code>ValidatorCustomizer</code> that can be loaded via
    <code>ServiceLoader</code> while the builder is constructing a
    <code>Validator</code> instance.
  </p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Customizer</span> <span class="kd">implements</span> <span class="n">ValidatorCustomizer</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">customize</span><span class="o">(</span><span class="n">Builder</span> <span class="n">builder</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">builder</span><span class="o">.</span><span class="na">failFast</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
  <h2 id="configuration">Configuration</h2>
  <p>
    Configuration of the Validator is provided by the <code>Validator.builder()</code>
    including setting the default locale, additional locales, additional resource
    bundles for overriding or customising messages etc.
  </p>
  <p>
    Refer to <a target="_blank" href="https://javadoc.io/doc/io.avaje/avaje-validator/latest/io.avaje.validation/io/avaje/validation/Validator.Builder.html">Validator.Builder</a>
    for full details of all the configuration options.
  </p>

  <h3 id="locales">Locales</h3>
  <p>
    We can specify the Locales that will be used for message interpolation
    and the default Locale.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="n">Validator</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">Validator</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
  <span class="o">.</span><span class="na">setDefaultLocale</span><span class="o">(</span><span class="n">Locale</span><span class="o">.</span><span class="na">ENGLISH</span><span class="o">)</span>
  <span class="o">.</span><span class="na">addLocales</span><span class="o">(</span><span class="n">Locale</span><span class="o">.</span><span class="na">GERMAN</span><span class="o">,</span> <span class="n">Locale</span><span class="o">.</span><span class="na">FRENCH</span><span class="o">,</span> <span class="n">Locale</span><span class="o">.</span><span class="na">ITALIAN</span><span class="o">)</span>
  <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></div>
</div>

  <h3 id="supportedLocales">Supported Locales</h3>
  <p>
    Locales with builtin messages for the standard validation annotations are:
  </p>
  <ul>
    <li>de - German</li>
    <li>en - English</li>
    <li>es - Spanish</li>
    <li>fa - Persian</li>
    <li>fr - French</li>
    <li>hu - Hungarian</li>
    <li>it - Italian</li>
    <li>ja - Japanese</li>
    <li>ko - Korean</li>
    <li>nl - Dutch</li>
    <li>pl - Polish</li>
    <li>pt - Portuguese</li>
    <li>ro - Romanian</li>
    <li>sk - Slovak</li>
    <li>tr - Turkish</li>
    <li>zh, zh_ZN, zh_TW - Chinese</li>
  </ul>

  <h3 id="additionalResourceBundles">Additional resource bundles</h3>
  <p>
    To override the built in messages or add messages for your own
    custom validation annotations, we can add custom resource bundles
    to the validator.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">// build using defaults</span>
<span class="n">Validator</span> <span class="n">validator</span> <span class="o">=</span> <span class="n">Validator</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
  <span class="o">.</span><span class="na">addResourceBundles</span><span class="o">(</span><span class="s">&quot;my.example.CustomMessages&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</pre></div>
</div>
  <p>
    Where <code>src/main/resources/my/example/CustomMessages.properties</code> contains
    extra messages that will be used.
  </p>
  <p>
    To support multiple Locales we would additionally add a properties file per Locale like below:
  </p>
  <ul>
    <li><code>src/main/resources/my/example/CustomMessages.properties</code></li>
    <li><code>src/main/resources/my/example/CustomMessages_en.properties</code></li>
    <li><code>src/main/resources/my/example/CustomMessages_de.properties</code></li>
    <li><code>src/main/resources/my/example/CustomMessages_fr.properties</code></li>
  </ul>
  <p>
    In this way the Locale specific message will be used, with a fallback to <em>CustomMessages.properties</em>.
  </p>

  <h2 id="constraint">Declaring and Validating Bean Constraints</h2>
  <p>
    Types annotated with <code>@Valid</code> are picked up by the avaje-validator-generator at compile time and an
    adapter is generated to perform validations.
  </p>
  <h3 id="field">Field Validation</h3>
  <p>
    Constraints can be expressed by annotating a field with 1 or more validation annotations.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Valid</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>

  <span class="nd">@NotBlank</span> <span class="nd">@Size</span><span class="o">(</span><span class="nx">max</span><span class="o">=</span><span class="mi">40</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">manufacturer</span><span class="o">;</span>

  <span class="nd">@AssertTrue</span>
  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">isRegistered</span><span class="o">;</span>

  <span class="c1">// getters...</span>
<span class="o">}</span>
</pre></div>
</div>

  <h3 id="getter">Getter Validation</h3>
  <p>
    It is also possible to annotate methods that have no arguments to validate the return type.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Valid</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="n">manufacturer</span><span class="o">;</span>

  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">isRegistered</span><span class="o">;</span>

  <span class="nd">@NotNull</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getManufacturer</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">manufacturer</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@AssertTrue</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isRegistered</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">isRegistered</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

  <h4 id="nullable">@Nullable</h4>
  <p>
    When a field/method is marked with any form of <code>@Nullable</code>, constraints will only take effect when the
    field/method result is not null.
  </p>

  <h3 id="container">Container element constraints</h3>
  <p>
    It is possible to specify constraints directly on the type argument of a parameterized type: these constraints are
    called container element constraints.
  </p>

  <p>
    Avaje Validator supports container element constraints specified on the following standard Java containers:
  </p>
  <ul>
    <li>implementations of <code>java.util.Iterable</code> (e.g. Lists, Sets),</li>
    <li>implementations of <code>java.util.Map</code>, with support for keys and values,</li>
  </ul>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Valid</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Ship</span> <span class="o">{</span>
  <span class="nd">@Valid</span>
  <span class="kd">private</span> <span class="nx">Map</span><span class="o">&lt;</span><span class="nd">@NotBlank</span> <span class="nx">String</span><span class="o">,</span> <span class="nd">@Valid</span> <span class="nd">@NotNull</span> <span class="nx">CrewMate</span><span class="o">&gt;</span> <span class="nx">crew</span><span class="o">;</span>

  <span class="nd">@Valid</span>
  <span class="kd">private</span> <span class="nx">List</span><span class="o">&lt;</span><span class="nd">@NotBlank</span> <span class="nx">String</span><span class="o">&gt;</span> <span class="nx">tasks</span><span class="o">;</span>

  <span class="c1">//getters...</span>
<span class="o">}</span>
</pre></div>
</div>

  <h4>Optional element constraints</h4>
  <p>
    Optional and their variants work slightly differently than regular container types. The values are automatically
    unwrapped, so constraints must be placed the the field itself instead of the container.
  </p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Valid</span>
<span class="kd">public</span> <span class="n">record</span> <span class="nf">CurseBearer</span><span class="o">(</span>
    <span class="nd">@NotBlank</span><span class="o">(</span><span class="nx">message</span> <span class="o">=</span> <span class="s">&quot;It&#39;ll happen to you too&quot;</span><span class="o">)</span> <span class="nx">Optional</span><span class="o">&lt;</span><span class="nx">String</span><span class="o">&gt;</span> <span class="nx">name</span><span class="o">,</span> <span class="c1">//the value contained within is validated</span>
    <span class="nd">@Positive</span> <span class="nx">OptionalInt</span> <span class="nx">estus</span><span class="o">,</span>
    <span class="nd">@Positive</span><span class="o">(</span><span class="nx">message</span> <span class="o">=</span> <span class="s">&quot;You Died&quot;</span><span class="o">)</span> <span class="nx">OptionalLong</span> <span class="nx">souls</span><span class="o">,</span>
    <span class="nd">@Positive</span><span class="o">(</span><span class="nx">message</span> <span class="o">=</span> <span class="s">&quot;vigor check failed&quot;</span><span class="o">)</span> <span class="nx">OptionalDouble</span> <span class="nx">vigor</span><span class="o">)</span> <span class="o">{}</span>
</pre></div>
</div>

  <h3 id="classlvl">Cross-Field / Class-level constraints</h3>
  <p>
    A constraint can also be placed on the class level for "Cross Field" validation.
    The input for the validation is the complete object and this is used when the validation depends
    on multiple properties of an object.
  </p>
  <p>
    A class level constraint is <em>ONLY</em> executed if all field level validations have already passed.
    The implementation is allowed to assume that all fields have already been deemed valid passing all
    field level validation constraints.
  </p>
  <p>
    The <code>UserRegistrationForm</code> class has <em>email</em> and <em>confirmEmail</em>
    and the validation requirement is that these 2 fields need to have matching values.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Valid</span>
<span class="nd">@RegistrationFormValidation</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserRegistrationForm</span> <span class="o">{</span>

  <span class="nd">@NotBlank</span> <span class="nd">@Email</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="o">;</span>

  <span class="nd">@NotBlank</span> <span class="nd">@Email</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">confirmEmail</span><span class="o">;</span>

  <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
  <h5>Step 1: Define the validation constraint annotation</h5>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Target</span><span class="o">(</span><span class="nx">TYPE</span><span class="o">)</span>
<span class="nd">@Constraint</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nx">SOURCE</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nx">RegistrationFormValidation</span> <span class="o">{</span>
  <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">&quot;Confirm Email must match Email&quot;</span><span class="o">;</span> <span class="c1">// default error message</span>

  <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span> <span class="c1">// groups</span>
<span class="o">}</span>
</pre></div>
</div>

  <h5>Step 2: Define a ConstraintAdapter for the annotation</h5>
  <p>
    We need to define a ConstraintAdapter that processes the <code>@RegistrationFormValidation</code>
    taking the <code>UserRegistrationForm</code> as input, and validation logic has access to
    all the fields.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@ConstraintAdapter</span><span class="o">(</span><span class="nx">RegistrationFormValidation</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">RegistrationFormValidationAdapter</span> <span class="kd">extends</span> <span class="n">AbstractConstraintAdapter</span><span class="o">&lt;</span><span class="n">UserRegistrationForm</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nf">RegistrationFormValidationAdapter</span><span class="o">(</span><span class="n">AdapterCreateRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="n">UserRegistrationForm</span> <span class="n">registrationForm</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// all field validation has passed</span>
    <span class="k">return</span> <span class="n">registrationForm</span><span class="o">.</span><span class="na">email</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">registrationForm</span><span class="o">.</span><span class="na">confirmEmail</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

  <h3 id="cascade">Cascaded Validation</h3>
  <p>
    Avaje Validator supports validating complete object graphs. To do so, just annotate a field or property
    representing a reference to another object with <code>@Valid</code>
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Valid</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Ship</span> <span class="o">{</span>

  <span class="nd">@Valid</span> <span class="c1">// an adapter will be generated for Crewmate as well</span>
  <span class="nd">@NotNull</span>
  <span class="kd">private</span> <span class="n">Crewmate</span> <span class="n">mate</span><span class="o">;</span>

  <span class="c1">// ...</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Crewmate</span> <span class="o">{</span>

  <span class="nd">@NotNull</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

  <span class="nd">@AssertFalse</span>
  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">sus</span><span class="o">;</span>

  <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>

  <h3 id="inherited">Inherited Constraints</h3>
  <p>
    When a class implements an interface or extends another class, all constraint annotations declared on the
    super-type
    apply in the same manner as the constraints specified on the class itself. To make things clearer, let's have a
    look
    at the following example:
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">manufacturer</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getManufacturer</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">manufacturer</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// ...</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">RentalCar</span> <span class="kd">extends</span> <span class="n">Car</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="n">rentalStation</span><span class="o">;</span>

  <span class="nd">@NotNull</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getRentalStation</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">rentalStation</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>

  <p>
    Here the class <code>RentalCar</code> is a subclass of <code>Car</code> and adds the property
    <code> rentalStation</code> . If an instance of <code>RentalCar</code> is
    validated, not only the <code>@NotNull</code> constraint on <code>rentalStation</code> is evaluated, but also the
    constraint on <code>manufacturer</code> from the parent class.

    The same would be true, if <code>Car</code> was not a superclass but an interface implemented by
    <code>RentalCar</code>.

    Constraint annotations are aggregated if methods are overridden. So if <code>RentalCar</code> overrode the
    <code>getManufacturer()</code> method from <code>Car</code>, any constraints annotated at the overriding method
    would be
    evaluated in addition to the <code>@NotNull</code> constraint from the superclass.
  </p>

  <h2 id="mixin">@Mixin</h2>

  <p>
    Say we want to override the validation behavior on a class we can't modify. (For example, a class in an external
    project/dependency). We can use <code>@Mixin</code> to add/override constraint annotations on the specified type.
  </p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Swallow</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">species</span><span class="o">;</span>
  <span class="nd">@Positive</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">avgSpeed</span><span class="o">;</span>
  <span class="nd">@AssertTrue</span>
  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">isLaden</span><span class="o">;</span>
  <span class="c1">//getters/setters...</span>
<span class="o">}</span>
</pre></div>
</div>
  <p>Given the above class, we can use the <code>@Mixin</code> annotation on an abstract class to effectively
    add/override constraint annotations.</p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@MixIn</span><span class="o">(</span><span class="nx">Swallow</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@EntryRiddleCheck</span> <span class="c1">//class constraints can be added as well</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">SwallowMixin</span> <span class="o">{</span>
  <span class="c1">//Add NotBlank</span>
  <span class="nd">@NotBlank</span><span class="o">(</span><span class="s">&quot;species shouldn&#39;t be null&quot;</span><span class="o">)</span>
  <span class="n">String</span> <span class="n">species</span><span class="o">;</span>

  <span class="c1">//adding the target field without any annotations disables the constraints</span>
  <span class="kt">boolean</span> <span class="n">isLaden</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
  <details>
    <summary>Generated Code: (click to expand)</summary>
    <p>Given the above mixin, the SwallowValidationAdapter becomes:</p>

    <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Generated</span><span class="o">(</span><span class="s">&quot;avaje-validator-generator&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">SwallowValidationAdapter</span> <span class="kd">implements</span> <span class="n">ValidationAdapter</span><span class="o">&lt;</span><span class="n">Swallow</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">final</span> <span class="n">ValidationAdapter</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">speciesValidationAdapter</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">ValidationAdapter</span><span class="o">.</span><span class="na">Primitive</span> <span class="n">avgSpeedValidationAdapter</span><span class="o">;</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">ValidationAdapter</span><span class="o">&lt;</span><span class="n">Swallow</span><span class="o">&gt;</span> <span class="n">swallowValidationAdapter</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">SwallowValidationAdapter</span><span class="o">(</span><span class="n">ValidationContext</span> <span class="n">ctx</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">speciesValidationAdapter</span> <span class="o">=</span>
        <span class="n">ctx</span><span class="o">.&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="n">adapter</span><span class="o">(</span><span class="n">NotBlank</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Map</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">&quot;max&quot;</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span> <span class="s">&quot;message&quot;</span><span class="o">,</span><span class="s">&quot;species shouldn\&#39;t be null&quot;</span><span class="o">,</span> <span class="s">&quot;_type&quot;</span><span class="o">,</span><span class="s">&quot;String&quot;</span><span class="o">));</span>

    <span class="k">this</span><span class="o">.</span><span class="na">avgSpeedValidationAdapter</span> <span class="o">=</span>
        <span class="n">ctx</span><span class="o">.&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="n">adapter</span><span class="o">(</span><span class="n">Positive</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Map</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">&quot;message&quot;</span><span class="o">,</span><span class="s">&quot;{avaje.Positive.message}&quot;</span><span class="o">,</span> <span class="s">&quot;_type&quot;</span><span class="o">,</span><span class="s">&quot;Integer&quot;</span><span class="o">))</span>
            <span class="o">.</span><span class="na">primitive</span><span class="o">();</span>

    <span class="k">this</span><span class="o">.</span><span class="na">swallowValidationAdapter</span> <span class="o">=</span>
        <span class="n">ctx</span><span class="o">.&lt;</span><span class="n">Swallow</span><span class="o">&gt;</span><span class="n">adapter</span><span class="o">(</span><span class="n">EntryRiddleCheck</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Map</span><span class="o">.</span><span class="na">of</span><span class="o">());</span>

  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">validate</span><span class="o">(</span><span class="n">Swallow</span> <span class="n">value</span><span class="o">,</span> <span class="n">ValidationRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">String</span> <span class="n">field</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">field</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">request</span><span class="o">.</span><span class="na">pushPath</span><span class="o">(</span><span class="n">field</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">var</span> <span class="n">_&#36;species</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">getSpecies</span><span class="o">();</span>
    <span class="n">speciesValidationAdapter</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">_&#36;species</span><span class="o">,</span> <span class="n">request</span><span class="o">,</span> <span class="s">&quot;species&quot;</span><span class="o">);</span>

    <span class="k">var</span> <span class="n">_&#36;avgSpeed</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="na">getAvgSpeed</span><span class="o">();</span>
    <span class="n">avgSpeedValidationAdapter</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">_&#36;avgSpeed</span><span class="o">,</span> <span class="n">request</span><span class="o">,</span> <span class="s">&quot;avgSpeed&quot;</span><span class="o">);</span>

    <span class="k">if</span> <span class="o">(!</span><span class="n">request</span><span class="o">.</span><span class="na">hasViolations</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">swallowValidationAdapter</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">value</span><span class="o">,</span> <span class="n">request</span><span class="o">,</span> <span class="n">field</span><span class="o">);</span>
    <span class="o">}</span>


    <span class="k">if</span> <span class="o">(</span><span class="n">field</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">request</span><span class="o">.</span><span class="na">popPath</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
  </details>

  <h2 id="methods">Method Validation</h2>
  <p>
    Constraints can not only be applied to POJOs and their properties, but also to the
    parameters and return values of the methods of Java types.
  </p>

  <h3>@ValidMethod</h3>
  <p>
    Adding <code>@ValidMethod</code> to a method will generate classes that contain adapters for the methods
    parameters/return types. These classes can be wired by a JSR-330 compliant DI library for use in AOP to execute
    the
    validations.
  </p>

  <p>
    Avaje Validator has an integration with Avaje Inject to provide a default AOP method validator for bean classes.
    So when used with avaje inject, the below method will be proxied and validated.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Singleton</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GraphService</span> <span class="o">{</span>

  <span class="nd">@ValidMethod</span>
  <span class="nd">@PositiveOrZero</span>
  <span class="kd">public</span> <span class="kt">long</span> <span class="nf">calculate</span><span class="o">(</span><span class="nd">@Positive</span> <span class="kt">int</span> <span class="nx">x</span><span class="o">,</span> <span class="nd">@Negative</span> <span class="kt">int</span> <span class="nx">x</span><span class="o">){</span>
    <span class="o">...</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
  <h4>Generated code</h4>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Generated</span>
<span class="nd">@Singleton</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">TestParamProvider</span> <span class="kd">implements</span> <span class="n">MethodAdapterProvider</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Method</span> <span class="nf">method</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">MethodTest</span><span class="o">.</span><span class="na field">class</span><span class="o">.</span><span class="na">getDeclaredMethod</span><span class="o">(</span><span class="s">&quot;test&quot;</span><span class="o">,</span> <span class="n">List</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="kt">int</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">ValidationAdapter</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="nf">paramAdapters</span><span class="o">(</span><span class="n">ValidationContext</span> <span class="n">ctx</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">List</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
        <span class="n">ctx</span><span class="o">.&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="n">adapter</span><span class="o">(</span><span class="n">Positive</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Map</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">&quot;groups&quot;</span><span class="o">,</span><span class="n">Set</span><span class="o">.</span><span class="na">of</span><span class="o">(),</span> <span class="s">&quot;message&quot;</span><span class="o">,</span><span class="s">&quot;{io.avaje.validation.constraints.Positive.message}&quot;</span><span class="o">)),</span>
        <span class="n">ctx</span><span class="o">.&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="n">adapter</span><span class="o">(</span><span class="n">Negative</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Map</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">&quot;groups&quot;</span><span class="o">,</span><span class="n">Set</span><span class="o">.</span><span class="na">of</span><span class="o">(),</span> <span class="s">&quot;message&quot;</span><span class="o">,</span><span class="s">&quot;{io.avaje.validation.constraints.Negative.message}&quot;</span><span class="o">)));</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">ValidationAdapter</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">returnAdapter</span><span class="o">(</span><span class="n">ValidationContext</span> <span class="n">ctx</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">ctx</span><span class="o">.&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="n">adapter</span><span class="o">(</span><span class="n">PositiveOrZero</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Map</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">&quot;groups&quot;</span><span class="o">,</span><span class="n">Set</span><span class="o">.</span><span class="na">of</span><span class="o">(),</span> <span class="s">&quot;message&quot;</span><span class="o">,</span><span class="s">&quot;{io.avaje.validation.constraints.message}&quot;</span><span class="o">));</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

  <h2 id="message">Constraint Error Messages</h2>

  <h3 id="message">Declaring Messages</h3>
  <p>
    Constraint violation messages are initially retrieved from the <em>message</em> annotation value. Each constraint
    defines its default message value using the <em>message</em>. At declaration time, the default value can be
    overridden with a specific value as shown below:
  </p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Valid</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>

  <span class="nd">@NotNull</span><span class="o">(</span><span class="nx">message</span> <span class="o">=</span> <span class="s">&quot;The manufacturer name must not be null&quot;</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">manufacturer</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>

  <h3 id="bundle">ResourceBundle Loading</h3>

  <p>
    If the message value begins and ends with brackets, avaje will check the configured <code>ResourceBundles</code>
    using the bracket contents. If any bundle contains an entry for a given message parameter, the messeage parameter
    will be
    replaced with the corresponding value from the bundle. This step will be executed recursively in case the
    replaced value begins/ends with brackets.
  </p>

  <p>The resource bundle is expected to be provided by the application
    developer, e.g. by adding a file named <code>ValidationMessages.properties</code> to the classpath and registering
    it via the builder (either by the filename or the bundle instance itself). You can also create localized
    error messages by providing locale specific variations of bundles, such as
    <code>ValidationMessages_en_US.properties</code>.
    When validating, you can provide the locale to use to lookup messages. By default,
    <code>Locale#getDefault()</code>
    will be used when looking up messages in the bundle.
  </p>

  <p> To register bundles with the validator, add the filename to the validator builder, or directly add the
    ResourceBundle instance to the builder.
  </p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Valid</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>
  <span class="c1">// will search configured bundles for bundle.key</span>
  <span class="nd">@NotNull</span><span class="o">(</span><span class="nx">message</span> <span class="o">=</span> <span class="s">&quot;{bundle.key}&quot;</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">manufacturer</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>

  <h3 id="interpolation">Message Interpolation</h3>
  <p>
    If a constraint is violated, its descriptor will be interpolated by the currently configured
    <code>MessageInterpolator</code>. The interpolated error message can then be retrieved from the resulting
    constraint violation by calling <code>ConstraintViolation#getMessage()</code>. Below is the signature for
    <code>MessageInterpolator</code>.
  </p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MessageInterpolator</span> <span class="o">{</span>

  <span class="cm">/**</span>
<span class="cm">   * Interpolate the given message with the annotation attributes</span>
<span class="cm">   *</span>
<span class="cm">   * @param template The template loaded from annotation/resourceBundle</span>
<span class="cm">   * @param attributes The Constraint annotation&#39;s attributes</span>
<span class="cm">   * @return The interpolated validation error message</span>
<span class="cm">   */</span>
  <span class="n">String</span> <span class="nf">interpolate</span><span class="o">(</span><span class="n">String</span> <span class="n">template</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">attributes</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>

  <h4>Default Message Interpolation</h4>
  <p>
    If no <code>MessageInterpolator</code> is provided, the default interpolator reads the
    string for brackets, then replaces them with the corresponding annotation attribute. See the below example.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Size</span><span class="o">(</span>
        <span class="n">min</span> <span class="o">=</span> <span class="mi">2</span><span class="o">,</span>
        <span class="n">max</span> <span class="o">=</span> <span class="mi">14</span><span class="o">,</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s">&quot;Value must be between {min} and {max} characters long&quot;</span>
<span class="o">)</span>
<span class="kd">private</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">values</span><span class="o">;</span>
</pre></div>
</div>

  <p>
    by default, the error message will be interpolated to: <em>Value must be between 2 and 14 characters long</em>.
  </p>

  <h2 id="groups">Grouping Constraints</h2>
  <p>
    All validation methods on <code>Validator</code> take a var-arg argument <code>groups</code>. Groups allow you to
    restrict the set of constraints applied during validation. One use case for validation groups are UI wizards where
    in each step only a specified subset of constraints should get validated. The groups targeted are passed as
    var-arg
    parameters to the appropriate validate method.
  </p>

  <p>
    Let's have a look at an example. Below we have a set of classes to be validated
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>

  <span class="nd">@NotNull</span> <span class="c1">//Group-less constraints will automatically be assigned the avaje Default group.</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">manufacturer</span><span class="o">;</span>

  <span class="nd">@NotNull</span>
  <span class="nd">@Size</span><span class="o">(</span><span class="nx">min</span> <span class="o">=</span> <span class="mi">2</span><span class="o">,</span> <span class="nx">max</span> <span class="o">=</span> <span class="mi">14</span><span class="o">)</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">licensePlate</span><span class="o">;</span>

  <span class="nd">@Min</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">seatCount</span><span class="o">;</span>

  <span class="c1">//Constraints with groups execute only if there is a group matching in the validation request.</span>
  <span class="nd">@AssertTrue</span><span class="o">(</span>
          <span class="n">message</span> <span class="o">=</span> <span class="s">&quot;The car has to pass the vehicle inspection first&quot;</span><span class="o">,</span>
          <span class="n">groups</span> <span class="o">=</span> <span class="n">CarChecks</span><span class="o">.</span><span class="na">class</span>
  <span class="o">)</span>
  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">passedVehicleInspection</span><span class="o">;</span>

  <span class="c1">// all-args contructor, getters ...</span>
<span class="o">}</span>
</pre></div>
</div>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">// create a car and check that everything is ok with it.</span>
<span class="n">Car</span> <span class="n">car</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Car</span><span class="o">(</span><span class="s">&quot;Morris&quot;</span><span class="o">,</span> <span class="s">&quot;DD-AB-123&quot;</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
<span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">car</span><span class="o">);</span> <span class="c1">// because inspection is not in default group no exception</span>
<span class="k">try</span> <span class="o">{</span>
<span class="c1">// Check the inspection (it won&#39;t pass)</span>
<span class="n">validator</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">car</span><span class="o">,</span> <span class="n">CarChecks</span><span class="o">.</span><span class="na">class</span> <span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ConstraintViolationException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>

  <span class="k">var</span> <span class="n">constraintViolations</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="na">violations</span><span class="o">();</span>
  <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">constraintViolations</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
  <span class="n">assertEquals</span><span class="o">(</span>
          <span class="s">&quot;The car has to pass the vehicle inspection first&quot;</span><span class="o">,</span>
          <span class="n">constraintViolations</span><span class="o">.</span><span class="na">iterator</span><span class="o">().</span><span class="na">next</span><span class="o">().</span><span class="na">getMessage</span><span class="o">()</span>
  <span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>

  <p>
    The first <code>validate()</code> call is done using no explicit group. There are no
    validation errors even though the property <code>passedVehicleInspection</code> is false, as the constraint
    defined
    on the property does not belong to the default group.
  </p>
  <p>
    The next validation using the <code>CarChecks</code> group fails until the car passes the vehicle inspection.
  </p>

  <h2 id="custom">Custom Constraints</h2>
  <p>
    Avaje Validation defines a whole set of standard constraint annotations such as <code>@NotNull</code>,
    <code>@Size</code> etc.
    In cases where these built-in constraints are not sufficient, you can easily create custom constraints tailored to
    your specific validation requirements.
  </p>

  <p>
    To create a custom constraint, the following two steps are required:
  </p>

  <ol>
    <li>Create a constraint annotation</li>
    <li>Implement an adapter to validate objects</li>
  </ol>

  <h3 id="constraints">@Constraint</h3>
  <p>
    We use the <code>@Constraint</code> annotation to mark an annotation class as a composable constraint annotation.
    The below example section shows how to write a constraint annotation which ensures that a given string is either
    completely upper case or lower case.
  </p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Constraint</span> <span class="c1">//for Jakarta/Javax versions, use @Constraint(validatedBy = { })</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nx">CheckCase</span> <span class="o">{</span>

    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">&quot;{io.avaje.validator.CheckCase}&quot;</span><span class="o">;</span> <span class="c1">//default error message</span>

    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{</span> <span class="o">};</span> <span class="c1">//groups</span>

    <span class="n">CaseMode</span> <span class="nf">value</span><span class="o">();</span> <span class="c1">//specify case mode</span>

    <span class="kd">public</span> <span class="kd">enum</span> <span class="n">CaseMode</span> <span class="o">{</span>
      <span class="n">UPPER</span><span class="o">,</span>
      <span class="n">LOWER</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

  <p>
    With our <code>@CheckCase</code> annotation in hand, we must now create a specialized
    <code>AbstractConstraintAdapter</code>
    that can validate a value using the annotation's attributes.
  </p>

  <h3 id="adapter">@ConstraintAdapter</h3>
  <p>
    We use the ConstraintAdapter to mark a type as a Constraint Adapter that targets a constraint annotation.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@ConstraintAdapter</span><span class="o">(</span><span class="nx">CheckCase</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">CheckCaseAdapter</span> <span class="kd">extends</span> <span class="n">AbstractConstraintAdapter</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kd">final</span> <span class="n">CaseMode</span> <span class="n">caseMode</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">CheckCaseAdapter</span><span class="o">(</span><span class="n">AdapterCreateRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
    <span class="kd">final</span> <span class="k">var</span> <span class="n">attributes</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">attributes</span><span class="o">();</span>
    <span class="n">caseMode</span> <span class="o">=</span> <span class="o">(</span><span class="n">CaseMode</span><span class="o">)</span> <span class="n">attributes</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;caseMode&quot;</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="n">String</span> <span class="n">object</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">caseMode</span> <span class="o">==</span> <span class="n">CaseMode</span><span class="o">.</span><span class="na">UPPER</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">object</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">object</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">object</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">object</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

  <p>
    The <code>AbstractConstraintAdapter</code> class defines one type parameter which describes the type of elements
    which the validator
    can handle (String). In case a constraint supports several data types, set the type as <code>Object</code> and use
    JDK 17+ pattern matching to validate each allowed type.
  </p>
  <p>
    The implementation of the validator is straightforward. The constructor gives you access to the attribute
    values of the constraint being validated and allows you to store them in a field as shown in the example.
  </p>
  <p>
    The <code>isValid()</code> method contains the actual validation logic. For <code>@CheckCase</code> this is the
    check whether a given string
    is either completely lower case or upper case, depending on the case mode retrieved by the constructor. Note that
    the Jakarta Bean Validation specification recommends to consider null values as being valid. If null is not a
    valid
    value for an element, it should be annotated with <code>@NotNull</code> explicitly.
  </p>

  <h3 id="cross">@CrossParamContraint</h3>
  <p>
    We use the <code>@CrossParamContraint</code> annotation to mark an annotation class as a composable constraint
    annotation for cross-parameter validations.
    These apply to the array of parameters of a method and can be used to express validation logic which depend on
    several parameter values.
  </p>

  <p>In the following example, we create a cross param contraint that validates whether a triangle abides by
    Pythagoras' theorum.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@CrossParamConstraint</span>
<span class="nd">@interface</span> <span class="nx">Pythagorean</span> <span class="o">{</span>
<span class="c1">// message and group members...</span>
<span class="o">}</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Geometry</span> <span class="o">{</span>
  <span class="nd">@Pythagorean</span>
  <span class="nd">@ValidMethod</span>
  <span class="n">String</span> <span class="nf">triangle</span><span class="o">(</span><span class="n">Integer</span> <span class="n">sideA</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">sideB</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">hypotenuse</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">regular</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>

  <p>Now we create the corresponding adapter for <code>@Pythagorean</code>. Cross-param adapters must accept an
    <code>Object[]</code> representing a method's parameters.
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@ConstraintAdapter</span><span class="o">(</span><span class="nx">Pythagorean</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">PythagoreanAdapter</span> <span class="kd">extends</span> <span class="n">AbstractConstraintAdapter</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">[]&gt;</span> <span class="o">{</span>

  <span class="kd">public</span> <span class="nf">PythagoreanAdapter</span><span class="o">(</span><span class="n">AdapterCreateRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="n">Object</span><span class="o">[]</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">var</span> <span class="n">a</span> <span class="o">=</span> <span class="o">(</span><span class="n">Integer</span><span class="o">)</span> <span class="n">params</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
    <span class="k">var</span> <span class="n">b</span> <span class="o">=</span> <span class="o">(</span><span class="n">Integer</span><span class="o">)</span> <span class="n">params</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
    <span class="k">var</span> <span class="n">c</span> <span class="o">=</span> <span class="o">(</span><span class="n">Integer</span><span class="o">)</span> <span class="n">params</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>

    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">b</span> <span class="o">==</span> <span class="n">c</span> <span class="o">*</span> <span class="n">c</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
  <h2 id="composable">Composing Constraints</h2>
  <p>
    You can create high level constraints that composed of several basic constraints <code>@NotNull</code>,
    <code>@Size</code> etc.
    To create a composed constraint, simply annotate the constraint declaration with <code>@Constraint</code> and its
    comprising constraints. The annotation processor will generate an adapter for the composable constraint that will
    execute the constraints in sequence.
  </p>

  <div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@NotNull</span>
<span class="nd">@Constraint</span>
<span class="nd">@Size</span><span class="o">(</span><span class="nx">min</span> <span class="o">=</span> <span class="mi">2</span><span class="o">,</span> <span class="nx">max</span> <span class="o">=</span> <span class="mi">14</span><span class="o">)</span>
<span class="nd">@CheckCase</span><span class="o">(</span><span class="nx">CaseMode</span><span class="o">.</span><span class="na">UPPER</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nx">ValidLicensePlate</span> <span class="o">{</span>

    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span> <span class="k">default</span> <span class="s">&quot;{io.avaje.ValidLicensePlate.message}&quot;</span><span class="o">;</span>

    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{</span> <span class="o">};</span>
<span class="o">}</span>
</pre></div>
</div>

  <p>
    Using the new composed constraint at the licensePlate field is fully equivalent to the previous version in the
    groups example, where the three constraints were declared directly at the field itself:
  </p>
  <div class="syntax java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>

  <span class="nd">@ValidLicensePlate</span>
  <span class="kd">private</span> <span class="n">String</span> <span class="n">licensePlate</span><span class="o">;</span>

  <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
    <p><br><br><br><br><br><br></p>

  </article>
</div>

<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="/js/site.js"></script>
</body>
</html>
